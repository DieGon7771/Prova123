name: ğŸš€ Deploy

on:
  push:
    branches: [main]
  workflow_dispatch:

# ğŸ”½ AGGIUNGI QUESTE PERMISSIONI ğŸ”½
permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    # ğŸ”½ AGGIUNGI ANCHE QUI ğŸ”½
    permissions:
      contents: write
      pages: write
      id-token: write
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4
        
      - name: ğŸ”‘ Inject API Key
        run: |
          echo "ğŸ”§ Sostituendo API Key..."
          sed -i "s/TMDB_API_KEY_PLACEHOLDER/${{ secrets.MY_KEY }}/g" index.html
          echo "âœ… Done"
          
      - name: ğŸš€ Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}  # âš ï¸ DEVE ESSERE GITHUB_TOKEN
          publish_dir: .
          publish_branch: main  # âš ï¸ CAMBIA: usa main, NON gh-pages
          keep_files: false
          commit_message: "ğŸš€ Deploy with API Key"
